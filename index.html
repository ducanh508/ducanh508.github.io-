<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Công Cụ Tài Xỉu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #00ff9d;
            --secondary-color: #007bff;
            --accent-color: #ff00aa;
            --dark-bg: #121212;
            --darker-bg: #0a0a0a;
            --text-color: #ffffff;
            --panel-bg: rgba(30, 30, 30, 0.85);
            --glass-effect: rgba(255, 255, 255, 0.05);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            user-select: none;
        }
        
        body {
            background-color: var(--dark-bg);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80') no-repeat center center;
            background-size: cover;
            z-index: -2;
            filter: blur(8px) brightness(0.7);
        }
        
        body::after {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(0, 50, 50, 0.8) 100%);
            z-index: -1;
        }
        
        /* Disable right click and devtools */
        body {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .login-box {
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            transform-style: preserve-3d;
            transform: perspective(1000px);
            transition: all 0.5s ease;
        }
        
        .login-box:hover {
            transform: perspective(1000px) rotateY(5deg) rotateX(5deg);
            box-shadow: 0 15px 35px rgba(0, 255, 157, 0.3);
        }
        
        .login-title {
            font-size: 28px;
            margin-bottom: 30px;
            color: var(--primary-color);
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.5);
        }
        
        .login-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 20px;
            background-color: var(--darker-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .login-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .login-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            background-color: #00e68a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        .login-btn:active {
            transform: translateY(0);
        }
        
        .mission-container {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        
        .mission-text {
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .mission-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .mission-btn:hover {
            background-color: #e6009e;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 0, 170, 0.3);
        }
        
        .check-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            margin-top: 20px;
        }
        
        .check-btn:hover {
            background-color: #0069d9;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 123, 255, 0.3);
        }
        
        /* Main App */
        .app-container {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #000;
        }
        
        .logout-btn {
            background-color: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            background-color: var(--primary-color);
            color: #000;
        }
        
        .tool-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            gap: 20px;
        }
        
        .tool-btn {
            padding: 12px 25px;
            background-color: var(--darker-bg);
            border: 1px solid var(--primary-color);
            color: var(--text-color);
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .tool-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 157, 0.2), transparent);
            transition: 0.5s;
        }
        
        .tool-btn:hover::before {
            left: 100%;
        }
        
        .tool-btn.active {
            background-color: var(--primary-color);
            color: #000;
        }
        
        .tool-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        .tool-container {
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            transition: all 0.5s ease;
        }
        
        .tool-container.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tool-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input[type="number"], input[type="text"], select {
            width: 100%;
            padding: 12px;
            background-color: var(--darker-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input[type="number"]:focus, input[type="text"]:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .submit-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
            display: block;
            margin: 0 auto;
            width: 200px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .submit-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .submit-btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        
        .submit-btn:hover {
            background-color: #00e68a;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        .result-container {
            margin-top: 30px;
            padding: 20px;
            background-color: var(--darker-bg);
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
            display: none;
            animation: slideIn 0.5s ease-in-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .result-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .prediction {
            font-size: 18px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .tai {
            color: #4CAF50;
            text-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
        }
        
        .xiu {
            color: #F44336;
            text-shadow: 0 0 5px rgba(244, 67, 54, 0.5);
        }
        
        .dice-probability {
            margin-top: 15px;
        }
        
        .probability-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .probability-bar {
            height: 10px;
            background-color: #333;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .probability-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 5px;
            transition: width 0.5s ease-in-out;
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .action-btn {
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border: none;
            position: relative;
            overflow: hidden;
        }
        
        .action-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .action-btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        .check-btn {
            background-color: #2196F3;
            color: white;
        }
        
        .history-btn {
            background-color: #673AB7;
            color: white;
        }
        
        .new-game-btn {
            background-color: #FF9800;
            color: black;
        }
        
        .back-btn {
            background-color: #9E9E9E;
            color: black;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .history-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .history-content {
            background-color: var(--darker-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 1000px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            animation: modalFadeIn 0.3s ease-in-out;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .history-title {
            font-size: 24px;
            color: var(--primary-color);
        }
        
        .close-history {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .close-history:hover {
            color: var(--primary-color);
            transform: rotate(90deg);
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .history-table th, .history-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-table th {
            background-color: rgba(0, 255, 157, 0.1);
            color: var(--primary-color);
            position: sticky;
            top: 0;
        }
        
        .history-table tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .correct {
            color: #4CAF50;
        }
        
        .incorrect {
            color: #F44336;
        }
        
        /* Bot Container */
        .bot-container {
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .bot-header {
            background-color: var(--darker-bg);
            padding: 15px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .bot-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            margin-right: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #000;
            overflow: hidden;
        }
        
        .bot-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .bot-name {
            font-weight: bold;
            font-size: 18px;
        }
        
        .bot-status {
            margin-left: auto;
            font-size: 12px;
            color: #00ff9d;
            display: flex;
            align-items: center;
        }
        
        .bot-status::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #00ff9d;
            margin-right: 5px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .bot-messages {
            height: 400px;
            overflow-y: auto;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.3);
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--darker-bg);
        }
        
        .bot-messages::-webkit-scrollbar {
            width: 6px;
        }
        
        .bot-messages::-webkit-scrollbar-track {
            background: var(--darker-bg);
        }
        
        .bot-messages::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 6px;
        }
        
        .message {
            margin-bottom: 15px;
            display: flex;
            animation: messageFadeIn 0.3s ease-in-out;
        }
        
        @keyframes messageFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bot-message {
            background-color: rgba(0, 255, 157, 0.1);
            padding: 12px 18px;
            border-radius: 0 18px 18px 18px;
            max-width: 80%;
            border: 1px solid rgba(0, 255, 157, 0.2);
            position: relative;
        }
        
        .bot-message::before {
            content: '';
            position: absolute;
            top: 0;
            left: -10px;
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-right-color: rgba(0, 255, 157, 0.1);
            border-left: 0;
            margin-top: 0;
        }
        
        .user-message {
            margin-left: auto;
            background-color: rgba(0, 123, 255, 0.1);
            padding: 12px 18px;
            border-radius: 18px 0 18px 18px;
            max-width: 80%;
            border: 1px solid rgba(0, 123, 255, 0.2);
            position: relative;
        }
        
        .user-message::after {
            content: '';
            position: absolute;
            top: 0;
            right: -10px;
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-left-color: rgba(0, 123, 255, 0.1);
            border-right: 0;
            margin-top: 0;
        }
        
        .message-time {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 5px;
            text-align: right;
        }
        
        .message-input-container {
            display: flex;
            padding: 15px;
            background-color: var(--darker-bg);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .message-input {
            flex: 1;
            padding: 12px;
            background-color: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .message-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(0, 255, 157, 0.3);
        }
        
        .send-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .send-btn:hover {
            background-color: #00e68a;
        }
        
        .game-frame {
            width: 100%;
            height: 600px;
            border: none;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Admin Panel */
        .admin-panel {
            display: none;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .admin-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary-color);
            text-align: center;
        }
        
        .admin-section {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary-color);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 5px;
        }
        
        .admin-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .admin-input {
            flex: 1;
            min-width: 200px;
            padding: 10px;
            background-color: var(--darker-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            color: var(--text-color);
        }
        
        .admin-btn {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: #000;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .admin-btn:hover {
            background-color: #00e68a;
            transform: translateY(-2px);
        }
        
        .keys-list {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .keys-list th, .keys-list td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .keys-list th {
            background-color: rgba(0, 255, 157, 0.1);
            color: var(--primary-color);
        }
        
        .keys-list tr:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }
        
        .delete-btn {
            background-color: #F44336;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 10px;
            padding: 20px;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
            z-index: 1001;
            animation: slideInRight 0.5s ease-in-out;
        }
        
        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100%); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .notification-title {
            font-size: 18px;
            color: var(--primary-color);
            font-weight: bold;
        }
        
        .close-notification {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 20px;
            cursor: pointer;
        }
        
        .notification-content {
            margin-bottom: 15px;
        }
        
        .notification-footer {
            text-align: center;
        }
        
        .notification-btn {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin: 0 5px;
        }
        
        /* Nickname Modal */
        .nickname-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .nickname-content {
            background-color: var(--darker-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            text-align: center;
        }
        
        .nickname-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .nickname-input {
            width: 100%;
            padding: 12px;
            margin-bottom: 20px;
            background-color: var(--dark-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 16px;
        }
        
        .nickname-submit {
            background-color: var(--primary-color);
            color: #000;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .nickname-submit:hover {
            background-color: #00e68a;
        }
        
        /* Music Player */
        .music-player {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: var(--panel-bg);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 999;
        }
        
        .music-control {
            background-color: var(--primary-color);
            color: #000;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .music-control:hover {
            transform: scale(1.1);
        }
        
        .music-info {
            padding-right: 10px;
            max-width: 200px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .music-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .music-artist {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* Tool V3 */
        .game-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .game-option {
            padding: 12px 20px;
            background-color: var(--darker-bg);
            border: 1px solid var(--primary-color);
            color: var(--text-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .game-option.active {
            background-color: var(--primary-color);
            color: #000;
        }
        
        .game-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.3);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .login-box {
                padding: 30px 20px;
            }
            
            .container {
                padding: 10px;
            }
            
            .tool-container {
                padding: 20px;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-btn {
                width: 100%;
            }
            
            .bot-messages {
                height: 300px;
                padding: 15px;
            }
            
            .message {
                margin-bottom: 10px;
            }
            
            .bot-message, .user-message {
                padding: 10px 15px;
                max-width: 90%;
            }
            
            .history-content {
                padding: 20px;
                width: 95%;
            }
            
            .music-player {
                bottom: 10px;
                left: 10px;
                right: 10px;
                justify-content: center;
                border-radius: 30px;
            }
            
            .music-info {
                display: none;
            }
        }
        
        /* Cursor Effects */
        .cursor-effect {
            position: fixed;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(0, 255, 157, 0.5);
            pointer-events: none;
            transform: translate(-50%, -50%);
            z-index: 9999;
            mix-blend-mode: screen;
            animation: cursorPulse 1.5s infinite;
        }
        
        @keyframes cursorPulse {
            0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.5; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        /* Copyright */
        .copyright {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
        }
    </style>
</head>
<body>
    <!-- Cursor Effect -->
    <div class="cursor-effect" id="cursor-effect"></div>
    
    <!-- Login Container -->
    <div class="login-container" id="login-container">
        <div class="login-box">
            <h1 class="login-title">ĐĂNG NHẬP CÔNG CỤ</h1>
            <input type="text" class="login-input" id="login-key" placeholder="Nhập key đăng nhập">
            <button class="login-btn" id="login-btn">ĐĂNG NHẬP</button>
            
            <div class="mission-container" id="mission-container">
                <p class="mission-text">Vui lòng làm nhiệm vụ để vào tool</p>
                <button class="mission-btn" id="mission-btn">NHẬN NHIỆM VỤ</button>
                <button class="check-btn" id="check-mission-btn">CHECK HOÀN THÀNH</button>
            </div>
        </div>
    </div>
    
    <!-- Nickname Modal -->
    <div class="nickname-modal" id="nickname-modal">
        <div class="nickname-content">
            <h2 class="nickname-title">TẠO NICKNAME</h2>
            <input type="text" class="nickname-input" id="nickname-input" placeholder="Nhập nickname của bạn">
            <button class="nickname-submit" id="nickname-submit">XÁC NHẬN</button>
        </div>
    </div>
    
    <!-- Main App Container -->
    <div class="app-container" id="app-container">
        <div class="header">
            <a href="#" class="logo">
                <i class="fas fa-dice"></i> TAI XIU TOOL
            </a>
            
            <div class="user-info">
                <div class="user-avatar" id="user-avatar">U</div>
                <span id="username-display">User</span>
                <button class="logout-btn" id="logout-btn">ĐĂNG XUẤT</button>
            </div>
        </div>
        
        <!-- Admin Panel -->
        <div class="admin-panel" id="admin-panel">
            <h2 class="admin-title">ADMIN CONTROL PANEL</h2>
            
            <div class="admin-section">
                <h3 class="section-title">Quản lý Key</h3>
                <div class="admin-controls">
                    <input type="text" class="admin-input" id="new-key-input" placeholder="Nhập key mới">
                    <input type="number" class="admin-input" id="key-usage-input" placeholder="Số lần sử dụng">
                    <input type="number" class="admin-input" id="key-duration-input" placeholder="Thời gian (phút)">
                    <button class="admin-btn" id="create-key-btn">Tạo Key</button>
                </div>
                
                <div class="admin-controls">
                    <label style="color: white;">
                        <input type="checkbox" id="free-access-checkbox"> Mở quyền truy cập free
                    </label>
                </div>
                
                <table class="keys-list">
                    <thead>
                        <tr>
                            <th>Key</th>
                            <th>Số lần sử dụng</th>
                            <th>Thời gian còn lại</th>
                            <th>Hành động</th>
                        </tr>
                    </thead>
                    <tbody id="keys-list-body">
                        <!-- Keys will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Tool Selector -->
        <div class="tool-selector">
            <button class="tool-btn active" data-tool="toolv1">Tool V1</button>
            <button class="tool-btn" data-tool="toolv2">Tool V2</button>
            <button class="tool-btn" data-tool="toolv3">Tool V3</button>
        </div>
        
        <!-- Tool V1 Container -->
        <div class="tool-container active" id="toolv1">
            <h2 class="tool-title">CÔNG CỤ PHÂN TÍCH TÀI XỈU</h2>
            
            <div class="input-group">
                <label for="dice1">Xí ngầu 1 (1-6):</label>
                <input type="number" id="dice1" min="1" max="6" placeholder="Nhập số xí ngầu 1">
            </div>
            
            <div class="input-group">
                <label for="dice2">Xí ngầu 2 (1-6):</label>
                <input type="number" id="dice2" min="1" max="6" placeholder="Nhập số xí ngầu 2">
            </div>
            
            <div class="input-group">
                <label for="dice3">Xí ngầu 3 (1-6):</label>
                <input type="number" id="dice3" min="1" max="6" placeholder="Nhập số xí ngầu 3">
            </div>
            
            <button class="submit-btn" id="analyze-btn">PHÂN TÍCH KẾT QUẢ</button>
            
            <div class="result-container" id="result-v1">
                <h3 class="result-title">KẾT QUẢ PHÂN TÍCH</h3>
                <p class="prediction" id="prediction-text"></p>
                <p id="position-prediction"></p>
                <p id="win-rate"></p>
                
                <div class="dice-probability">
                    <h4>Dự đoán xí ngầu ván tiếp theo:</h4>
                    <div id="next-dice-prob">
                        <div class="probability-item">
                            <span>Xí ngầu dự đoán:</span>
                            <span id="next-dice-value">-</span>
                        </div>
                        <div class="probability-bar">
                            <div class="probability-fill" id="next-dice-bar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="action-btn check-btn" id="check-result-btn">Check Kết Quả</button>
                    <button class="action-btn history-btn" id="history-btn">Lịch Sử</button>
                    <button class="action-btn new-game-btn" id="new-game-btn">Ván Mới</button>
                </div>
            </div>
        </div>
        
        <!-- Tool V2 Container -->
        <div class="tool-container" id="toolv2">
            <h2 class="tool-title">BOT TÀI XỈU TỰ ĐỘNG</h2>
            
            <div class="bot-container">
                <div class="bot-header">
                    <div class="bot-avatar">
                        <img src="https://media.istockphoto.com/id/1445426863/vector/chat-bot-vector-logo-design-concept.jpg?s=612x612&w=0&k=20&c=XDdfzS4lNW9yxQ0BQGZq9KMLL4bJ8ywXlYdAhBSuoCA=" alt="Bot Avatar">
                    </div>
                    <div class="bot-name">TaiXiu Analyzer</div>
                    <div class="bot-status">Đang hoạt động</div>
                </div>
                
                <div class="bot-messages" id="bot-messages">
                    <div class="message">
                        <div class="bot-message">
                            Xin chào! Tôi là bot phân tích Tài Xỉu. Vui lòng nhập 3 số xúc xắc vừa ra trong game để tôi phân tích.
                            <div class="message-time">Bây giờ</div>
                        </div>
                    </div>
                </div>
                
                <div class="message-input-container">
                    <input type="text" class="message-input" id="user-message" placeholder="Nhập 3 số xúc xắc (ví dụ: 2 4 6)">
                    <button class="send-btn" id="send-btn">Gửi</button>
                    <button class="history-btn" id="bot-history-btn" style="margin-left: 10px;">Lịch Sử</button>
                </div>
            </div>
        </div>
        
        <!-- Tool V3 Container -->
        <div class="tool-container" id="toolv3">
            <h2 class="tool-title">BOT TÀI XỈU TỰ ĐỘNG TRONG GAME</h2>
            
            <div class="game-selector">
                <button class="game-option active" data-game="sunwin">Sun Win</button>
                <button class="game-option" data-game="hitclub">Hit Club</button>
                <button class="game-option" data-game="68gb">68GB</button>
            </div>
            
            <button class="submit-btn" id="start-game-btn">BẮT ĐẦU BOT</button>
            
            <div id="game-container" style="display: none;">
                <iframe src="" class="game-frame" id="game-frame"></iframe>
                
                <div class="bot-container">
                    <div class="bot-header">
                        <div class="bot-avatar">
                            <img src="https://media.istockphoto.com/id/1445426863/vector/chat-bot-vector-logo-design-concept.jpg?s=612x612&w=0&k=20&c=XDdfzS4lNW9yxQ0BQGZq9KMLL4bJ8ywXlYdAhBSuoCA=" alt="Bot Avatar">
                        </div>
                        <div class="bot-name">Auto TaiXiu Bot</div>
                        <div class="bot-status">Đang chờ</div>
                    </div>
                    
                    <div class="bot-messages" id="auto-bot-messages">
                        <div class="message">
                            <div class="bot-message">
                                Bot sẽ tự động phân tích kết quả từ game và đưa ra dự đoán mỗi 50 giây.
                                <div class="message-time">Bây giờ</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Copyright -->
        <div class="copyright">
            <p>© 2023 TAI XIU TOOL | Created by <strong>@bevis1312</strong></p>
        </div>
    </div>
    
    <!-- History Modal -->
    <div class="history-modal" id="history-modal">
        <div class="history-content">
            <div class="history-header">
                <h3 class="history-title">LỊCH SỬ DỰ ĐOÁN</h3>
                <button class="close-history" id="close-history">&times;</button>
            </div>
            
            <table class="history-table">
                <thead>
                    <tr>
                        <th>Ván</th>
                        <th>Dự đoán</th>
                        <th>Kết quả</th>
                        <th>Trạng thái</th>
                        <th>Thời gian</th>
                    </tr>
                </thead>
                <tbody id="history-table-body">
                    <!-- History data will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="notification">
        <div class="notification-header">
            <h3 class="notification-title">THÔNG BÁO</h3>
            <button class="close-notification" id="close-notification">&times;</button>
        </div>
        <div class="notification-content">
            <p><strong>ADMIN TOOL:</strong> @bevis1312</p>
            <p><strong>CỔNG GAME HỖ TRỢ:</strong> ALL CỔNG GAME</p>
            <p>AE CÓ THỂ GIA NHẬP NHÓM TELE KÉO TÀI XỈU: <a href="https://t.me/keocau68gamebai_sunwin" style="color: var(--primary-color);">https://t.me/keocau68gamebai_sunwin</a></p>
            <p><strong>NOTE:</strong> WEB TOOL HOÀN TOÀN LÀ FREE, CÁC CÔNG THỨC MÌNH LÀM HOÀN TOÀN LÀ XÁC SUẤT CHÍNH XÁC 60-70%, KHÔNG PHẢI LÀ RANDOM, MÌNH KHÔNG LẤY TIỀN HAY THỜI GIAN CÔNG SỨC CỦA AE, NẾU AE THẤY TOOL DÙNG HAY, OK THÌ CÓ THỂ CHIA SẺ TỚI BẠN BÈ ĐỂ CÙNG BIẾT, VÀ AE CÓ THẮC MẮC GÌ VUI LÒNG LIÊN HỆ TELE: @BEVIS1312 NHÉ, VUI LÒNG KHÔNG DÙNG TOOL CHO CÁC HOẠT ĐỘNG BUÔN BÁN KIẾM LỜI CHO BẢN THÂN, CẢM ƠN AE ĐÃ ỦNG HỘ.</p>
        </div>
        <div class="notification-footer">
            <button class="notification-btn" id="hide-notification-btn">Ẩn trong 1 giờ</button>
            <button class="notification-btn" id="close-notification-btn">Đóng</button>
        </div>
    </div>
    
    <!-- Music Player -->
    <div class="music-player" id="music-player">
        <div class="music-control" id="play-btn">
            <i class="fas fa-play"></i>
        </div>
        <div class="music-info">
            <div class="music-title" id="music-title">Loading...</div>
            <div class="music-artist" id="music-artist">Artist</div>
        </div>
        <audio id="background-music" loop>
            <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
        </audio>
    </div>
    
    <script>
        // Disable right click and devtools
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            showNotification('Thông báo', 'Hành động này đã bị vô hiệu hóa', 'error');
        });
        
        // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C, Ctrl+U
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') || 
                (e.ctrlKey && e.shiftKey && e.key === 'J') || 
                (e.ctrlKey && e.shiftKey && e.key === 'C') || 
                (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                showNotification('Thông báo', 'Hành động này đã bị vô hiệu hóa', 'error');
            }
        });
        
        // Custom cursor effect
        const cursorEffect = document.getElementById('cursor-effect');
        document.addEventListener('mousemove', (e) => {
            cursorEffect.style.left = e.clientX + 'px';
            cursorEffect.style.top = e.clientY + 'px';
        });
        
        // Click sound effect
        const clickSound = new Audio('https://www.soundjay.com/buttons/sounds/button-09.mp3');
        document.querySelectorAll('button, a, input[type="text"], input[type="number"], .tool-btn').forEach(element => {
            element.addEventListener('click', () => {
                clickSound.currentTime = 0;
                clickSound.play();
            });
        });
        
        // Hover sound effect
        const hoverSound = new Audio('https://www.soundjay.com/buttons/sounds/button-10.mp3');
        document.querySelectorAll('button, a, .tool-btn').forEach(element => {
            element.addEventListener('mouseenter', () => {
                hoverSound.currentTime = 0;
                hoverSound.play();
            });
        });
        
        // Music player
        const musicPlayer = document.getElementById('music-player');
        const playBtn = document.getElementById('play-btn');
        const backgroundMusic = document.getElementById('background-music');
        const musicTitle = document.getElementById('music-title');
        const musicArtist = document.getElementById('music-artist');
        
        // Set music info
        musicTitle.textContent = "SoundHelix Song";
        musicArtist.textContent = "SoundHelix";
        
        playBtn.addEventListener('click', () => {
            if (backgroundMusic.paused) {
                backgroundMusic.play();
                playBtn.innerHTML = '<i class="fas fa-pause"></i>';
            } else {
                backgroundMusic.pause();
                playBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        });
        
        // Login system
        const loginContainer = document.getElementById('login-container');
        const appContainer = document.getElementById('app-container');
        const loginKeyInput = document.getElementById('login-key');
        const loginBtn = document.getElementById('login-btn');
        const missionContainer = document.getElementById('mission-container');
        const missionBtn = document.getElementById('mission-btn');
        const checkMissionBtn = document.getElementById('check-mission-btn');
        const nicknameModal = document.getElementById('nickname-modal');
        const nicknameInput = document.getElementById('nickname-input');
        const nicknameSubmit = document.getElementById('nickname-submit');
        const userAvatar = document.getElementById('user-avatar');
        const usernameDisplay = document.getElementById('username-display');
        const logoutBtn = document.getElementById('logout-btn');
        const adminPanel = document.getElementById('admin-panel');
        
        // Key management
        const ADMIN_KEY = 'bevis';
        const FREE_KEY = 'freekey';
        let freeAccessEnabled = false;
        let keys = JSON.parse(localStorage.getItem('taiXiuKeys')) || [];
        let users = JSON.parse(localStorage.getItem('taiXiuUsers')) || {};
        let currentUser = null;
        
        // Initialize keys if empty
        if (keys.length === 0) {
            keys.push({
                key: ADMIN_KEY,
                usageLimit: 1,
                remainingUsage: 1,
                duration: 0, // 0 means unlimited
                createdAt: new Date().toISOString(),
                isAdmin: true
            });
            
            keys.push({
                key: FREE_KEY,
                usageLimit: 1000,
                remainingUsage: 1000,
                duration: 0,
                createdAt: new Date().toISOString(),
                isAdmin: false
            });
            
            localStorage.setItem('taiXiuKeys', JSON.stringify(keys));
        }
        
        // Check if free access is enabled
        if (localStorage.getItem('freeAccessEnabled')) {
            freeAccessEnabled = localStorage.getItem('freeAccessEnabled') === 'true';
        }
        
        // Admin controls
        const newKeyInput = document.getElementById('new-key-input');
        const keyUsageInput = document.getElementById('key-usage-input');
        const keyDurationInput = document.getElementById('key-duration-input');
        const createKeyBtn = document.getElementById('create-key-btn');
        const freeAccessCheckbox = document.getElementById('free-access-checkbox');
        const keysListBody = document.getElementById('keys-list-body');
        
        freeAccessCheckbox.checked = freeAccessEnabled;
        
        freeAccessCheckbox.addEventListener('change', () => {
            freeAccessEnabled = freeAccessCheckbox.checked;
            localStorage.setItem('freeAccessEnabled', freeAccessEnabled);
            showNotification('Thông báo', `Quyền truy cập free đã được ${freeAccessEnabled ? 'mở' : 'đóng'}`, 'success');
        });
        
        createKeyBtn.addEventListener('click', () => {
            const key = newKeyInput.value.trim();
            const usageLimit = parseInt(keyUsageInput.value);
            const duration = parseInt(keyDurationInput.value);
            
            if (!key) {
                showNotification('Lỗi', 'Vui lòng nhập key', 'error');
                return;
            }
            
            if (isNaN(usageLimit) || usageLimit <= 0) {
                showNotification('Lỗi', 'Vui lòng nhập số lần sử dụng hợp lệ', 'error');
                return;
            }
            
            if (isNaN(duration) || duration < 0) {
                showNotification('Lỗi', 'Vui lòng nhập thời gian hợp lệ', 'error');
                return;
            }
            
            // Check if key already exists
            if (keys.some(k => k.key === key)) {
                showNotification('Lỗi', 'Key đã tồn tại', 'error');
                return;
            }
            
            // Add new key
            keys.push({
                key,
                usageLimit,
                remainingUsage: usageLimit,
                duration,
                createdAt: new Date().toISOString(),
                isAdmin: false
            });
            
            localStorage.setItem('taiXiuKeys', JSON.stringify(keys));
            renderKeysList();
            
            newKeyInput.value = '';
            keyUsageInput.value = '';
            keyDurationInput.value = '';
            
            showNotification('Thành công', 'Key đã được tạo', 'success');
        });
        
        function renderKeysList() {
            keysListBody.innerHTML = '';
            
            keys.forEach((keyObj, index) => {
                if (keyObj.key === ADMIN_KEY) return; // Don't show admin key
                
                const row = document.createElement('tr');
                
                // Calculate remaining time
                let remainingTime = 'Vô thời hạn';
                if (keyObj.duration > 0) {
                    const createdAt = new Date(keyObj.createdAt);
                    const expiresAt = new Date(createdAt.getTime() + keyObj.duration * 60000);
                    const now = new Date();
                    
                    if (now > expiresAt) {
                        remainingTime = 'Hết hạn';
                    } else {
                        const diff = expiresAt - now;
                        const hours = Math.floor(diff / (1000 * 60 * 60));
                        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                        remainingTime = `${hours}h ${minutes}m`;
                    }
                }
                
                row.innerHTML = `
                    <td>${keyObj.key}</td>
                    <td>${keyObj.remainingUsage}/${keyObj.usageLimit}</td>
                    <td>${remainingTime}</td>
                    <td><button class="delete-btn" data-index="${index}">Xóa</button></td>
                `;
                
                keysListBody.appendChild(row);
            });
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const index = parseInt(e.target.getAttribute('data-index'));
                    keys.splice(index, 1);
                    localStorage.setItem('taiXiuKeys', JSON.stringify(keys));
                    renderKeysList();
                    showNotification('Thành công', 'Key đã được xóa', 'success');
                });
            });
        }
        
        // Login function
        loginBtn.addEventListener('click', () => {
            const key = loginKeyInput.value.trim();
            
            if (!key) {
                showNotification('Lỗi', 'Vui lòng nhập key', 'error');
                return;
            }
            
            // Check if key is valid
            const keyObj = keys.find(k => k.key === key);
            const isAdmin = key === ADMIN_KEY;
            const isFreeKey = key === FREE_KEY;
            
            if (isAdmin || (keyObj && (keyObj.remainingUsage > 0 || keyObj.usageLimit === 0)) || (isFreeKey && freeAccessEnabled)) {
                // For non-admin keys, decrease remaining usage
                if (keyObj && !isAdmin) {
                    if (keyObj.remainingUsage > 0) {
                        keyObj.remainingUsage--;
                        localStorage.setItem('taiXiuKeys', JSON.stringify(keys));
                    }
                }
                
                // Show mission for non-admin keys
                if (!isAdmin) {
                    missionContainer.style.display = 'block';
                    currentUser = { key, isAdmin: false };
                } else {
                    // Admin goes straight to app
                    currentUser = { key, isAdmin: true };
                    showNicknameModal();
                }
                
                showNotification('Thành công', 'Key hợp lệ', 'success');
            } else if (isFreeKey && !freeAccessEnabled) {
                showNotification('Lỗi', 'Quyền truy cập free đang bị đóng', 'error');
            } else {
                showNotification('Lỗi', 'Key không hợp lệ hoặc đã hết hạn', 'error');
            }
        });
        
        // Mission button
        missionBtn.addEventListener('click', () => {
            window.open('https://t.me/keocau68gamebai_sunwin', '_blank');
        });
        
        // Check mission button
        checkMissionBtn.addEventListener('click', () => {
            showNotification('Thông báo', 'Đang kiểm tra...', 'info');
            
            // Simulate checking after 5 seconds
            setTimeout(() => {
                // In a real app, you would actually check if user joined the group
                // For demo purposes, we'll assume they did
                showNotification('Thành công', 'Bạn đã hoàn thành nhiệm vụ', 'success');
                showNicknameModal();
            }, 5000);
        });
        
        // Show nickname modal
        function showNicknameModal() {
            nicknameModal.style.display = 'flex';
        }
        
        // Nickname submission
        nicknameSubmit.addEventListener('click', () => {
            const nickname = nicknameInput.value.trim();
            
            if (!nickname) {
                showNotification('Lỗi', 'Vui lòng nhập nickname', 'error');
                return;
            }
            
            // Save user
            if (!users[currentUser.key]) {
                users[currentUser.key] = {
                    nickname,
                    joinedAt: new Date().toISOString(),
                    key: currentUser.key,
                    isAdmin: currentUser.isAdmin
                };
                
                localStorage.setItem('taiXiuUsers', JSON.stringify(users));
            }
            
            currentUser.nickname = nickname;
            
            // Initialize user stats if not exists
            if (!localStorage.getItem('userStats')) {
                localStorage.setItem('userStats', JSON.stringify({}));
            }
            
            nicknameModal.style.display = 'none';
            loginContainer.style.display = 'none';
            appContainer.style.display = 'block';
            
            // Update UI
            userAvatar.textContent = nickname.charAt(0).toUpperCase();
            usernameDisplay.textContent = nickname;
            
            // Show admin panel if admin
            if (currentUser.isAdmin) {
                adminPanel.style.display = 'block';
                renderKeysList();
            }
            
            // Show notification
            setTimeout(() => {
                showMainNotification();
            }, 1000);
        });
        
        // Logout
        logoutBtn.addEventListener('click', () => {
            currentUser = null;
            appContainer.style.display = 'none';
            loginContainer.style.display = 'flex';
            loginKeyInput.value = '';
            missionContainer.style.display = 'none';
            
            // Reset tool containers
            document.querySelectorAll('.tool-container').forEach(container => {
                container.style.display = 'none';
            });
            document.getElementById('toolv1').style.display = 'block';
            
            // Reset active tool button
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.tool-btn[data-tool="toolv1"]').classList.add('active');
        });
        
        // Show main notification
        function showMainNotification() {
            // Check if notification was hidden
            const notificationHiddenUntil = localStorage.getItem('notificationHiddenUntil');
            if (notificationHiddenUntil && new Date(notificationHiddenUntil) > new Date()) {
                return;
            }
            
            document.getElementById('notification').style.display = 'block';
        }
        
        // Close notification
        document.getElementById('close-notification-btn').addEventListener('click', () => {
            document.getElementById('notification').style.display = 'none';
        });
        
        // Hide notification for 1 hour
        document.getElementById('hide-notification-btn').addEventListener('click', () => {
            const now = new Date();
            const hideUntil = new Date(now.getTime() + 60 * 60 * 1000); // 1 hour
            localStorage.setItem('notificationHiddenUntil', hideUntil.toISOString());
            document.getElementById('notification').style.display = 'none';
        });
        
        // Close notification with X button
        document.getElementById('close-notification').addEventListener('click', () => {
            document.getElementById('notification').style.display = 'none';
        });
        
        // Show notification function
        function showNotification(title, message, type) {
            // In a real app, you would show a proper notification
            alert(`[${title}] ${message}`);
        }
        
        // Tool selection
        const toolBtns = document.querySelectorAll('.tool-btn');
        const toolContainers = document.querySelectorAll('.tool-container');
        
        toolBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const toolId = btn.getAttribute('data-tool');
                
                toolBtns.forEach(b => b.classList.remove('active'));
                toolContainers.forEach(c => c.classList.remove('active'));
                
                btn.classList.add('active');
                document.getElementById(toolId).classList.add('active');
            });
        });
        
        // Tool V1 functionality
        const analyzeBtn = document.getElementById('analyze-btn');
        const resultV1 = document.getElementById('result-v1');
        const predictionText = document.getElementById('prediction-text');
        const positionPrediction = document.getElementById('position-prediction');
        const winRate = document.getElementById('win-rate');
        const checkResultBtn = document.getElementById('check-result-btn');
        const historyBtn = document.getElementById('history-btn');
        const newGameBtn = document.getElementById('new-game-btn');
        const historyModal = document.getElementById('history-modal');
        const closeHistory = document.getElementById('close-history');
        const historyTableBody = document.getElementById('history-table-body');
        const nextDiceValue = document.getElementById('next-dice-value');
        const nextDiceBar = document.getElementById('next-dice-bar');
        
        let gameHistory = JSON.parse(localStorage.getItem('taiXiuGameHistory')) || [];
        let currentPrediction = null;
        
        // Improved probability calculation
        function calculateTaiXiuProbability(dice1, dice2, dice3) {
            const sum = dice1 + dice2 + dice3;
            const isTai = sum > 10;
            
            // Calculate base probability (60-70% as requested)
            const baseProbability = 60 + Math.floor(Math.random() * 11); // 60-70%
            
            // Adjust probability based on recent history (last 5 games)
            if (gameHistory.length > 0) {
                const lastGames = gameHistory.slice(-5);
                const lastTaiCount = lastGames.filter(g => g.prediction === 'TÀI').length;
                const lastXiuCount = lastGames.filter(g => g.prediction === 'XỈU').length;
                
                if (isTai && lastTaiCount >= 3) {
                    // If last games had many TAI, decrease probability slightly
                    return Math.max(50, baseProbability - 5);
                } else if (!isTai && lastXiuCount >= 3) {
                    // If last games had many XIU, decrease probability slightly
                    return Math.max(50, baseProbability - 5);
                }
            }
            
            return baseProbability;
        }
        
        // Predict next dice values
        function predictNextDice(isTai) {
            if (isTai) {
                // Predict TAI values (11-18)
                const values = [];
                for (let i = 0; i < 3; i++) {
                    values.push(Math.floor(Math.random() * 8) + 11); // 11-18
                }
                return {
                    values: values.sort((a, b) => a - b),
                    probability: 65 + Math.floor(Math.random() * 6) // 65-70%
                };
            } else {
                // Predict XIU values (3-10)
                const values = [];
                for (let i = 0; i < 3; i++) {
                    values.push(Math.floor(Math.random() * 8) + 3); // 3-10
                }
                return {
                    values: values.sort((a, b) => a - b),
                    probability: 65 + Math.floor(Math.random() * 6) // 65-70%
                };
            }
        }
        
        analyzeBtn.addEventListener('click', () => {
            const dice1 = parseInt(document.getElementById('dice1').value);
            const dice2 = parseInt(document.getElementById('dice2').value);
            const dice3 = parseInt(document.getElementById('dice3').value);
            
            if (isNaN(dice1) || isNaN(dice2) || isNaN(dice3) || 
                dice1 < 1 || dice1 > 6 || 
                dice2 < 1 || dice2 > 6 || 
                dice3 < 1 || dice3 > 6) {
                showNotification('Lỗi', 'Vui lòng nhập số xí ngầu hợp lệ (1-6)', 'error');
                return;
            }
            
            // Calculate sum
            const sum = dice1 + dice2 + dice3;
            const isTai = sum > 10;
            
            // Calculate probability (60-70% as requested)
            const winProbability = calculateTaiXiuProbability(dice1, dice2, dice3);
            
            // Predict next dice values
            const nextDicePrediction = predictNextDice(!isTai); // Predict opposite for more "intelligence"
            
            // Set prediction text
            if (!isTai) { // Predict opposite of current result for better strategy
                predictionText.innerHTML = `Phiên này bạn hãy chọn: <span class="tai">TÀI</span>`;
                positionPrediction.innerHTML = `Dự đoán vị: <span class="tai">Tài: ${nextDicePrediction.values.join(', ')}</span>`;
            } else {
                predictionText.innerHTML = `Phiên này bạn hãy chọn: <span class="xiu">XỈU</span>`;
                positionPrediction.innerHTML = `Dự đoán vị: <span class="xiu">Xỉu: ${nextDicePrediction.values.join(', ')}</span>`;
            }
            
            winRate.textContent = `Tỉ lệ thắng: ${winProbability}%`;
            
            // Show next dice prediction
            nextDiceValue.textContent = nextDicePrediction.values.join(', ');
            nextDiceBar.style.width = `${nextDicePrediction.probability}%`;
            
            // Store current prediction
            currentPrediction = {
                dice: [dice1, dice2, dice3],
                prediction: !isTai ? 'TÀI' : 'XỈU', // Predict opposite
                position: nextDicePrediction.values,
                winProbability,
                timestamp: new Date().toLocaleString()
            };
            
            // Show result
            resultV1.style.display = 'block';
        });
        
        checkResultBtn.addEventListener('click', () => {
            if (!currentPrediction) return;
            
            const result = prompt('Kết quả trong game là Tài hay Xỉu? (Nhập "tai" hoặc "xiu")');
            
            if (result && (result.toLowerCase() === 'tai' || result.toLowerCase() === 'xiu')) {
                const isCorrect = (result.toLowerCase() === 'tai' && currentPrediction.prediction === 'TÀI') || 
                                 (result.toLowerCase() === 'xiu' && currentPrediction.prediction === 'XỈU');
                
                // Add to history
                gameHistory.push({
                    ...currentPrediction,
                    actualResult: result.toUpperCase(),
                    isCorrect
                });
                
                localStorage.setItem('taiXiuGameHistory', JSON.stringify(gameHistory));
                
                showNotification('Kết quả', `${result.toUpperCase()}. Dự đoán ${isCorrect ? 'ĐÚNG' : 'SAI'}`, isCorrect ? 'success' : 'error');
            }
        });
        
        historyBtn.addEventListener('click', () => {
            renderHistory();
            historyModal.style.display = 'flex';
        });
        
        closeHistory.addEventListener('click', () => {
            historyModal.style.display = 'none';
        });
        
        newGameBtn.addEventListener('click', () => {
            document.getElementById('dice1').value = '';
            document.getElementById('dice2').value = '';
            document.getElementById('dice3').value = '';
            resultV1.style.display = 'none';
            currentPrediction = null;
        });
        
        function renderHistory() {
            historyTableBody.innerHTML = '';
            
            if (gameHistory.length === 0) {
                historyTableBody.innerHTML = '<tr><td colspan="5" style="text-align: center;">Chưa có lịch sử</td></tr>';
                return;
            }
            
            gameHistory.slice().reverse().forEach((game, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${gameHistory.length - index}</td>
                    <td>${game.prediction}</td>
                    <td>${game.actualResult || 'Chưa cập nhật'}</td>
                    <td class="${game.isCorrect ? 'correct' : 'incorrect'}">${game.isCorrect ? 'ĐÚNG' : 'SAI'}</td>
                    <td>${game.timestamp}</td>
                `;
                
                historyTableBody.appendChild(row);
            });
        }
        
        // Tool V2 functionality
        const sendBtn = document.getElementById('send-btn');
        const userMessage = document.getElementById('user-message');
        const botMessages = document.getElementById('bot-messages');
        const botHistoryBtn = document.getElementById('bot-history-btn');
        
        sendBtn.addEventListener('click', sendBotMessage);
        userMessage.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendBotMessage();
        });
        
        function sendBotMessage() {
            const text = userMessage.value.trim();
            if (!text) return;
            
            // Add user message
            addUserMessage(text);
            userMessage.value = '';
            
            // Check if message is 3 dice numbers
            const diceNumbers = text.split(' ').map(num => parseInt(num)).filter(num => !isNaN(num) && num >= 1 && num <= 6);
            
            if (diceNumbers.length === 3) {
                // Analyze the dice
                setTimeout(() => {
                    analyzeDiceForBot(diceNumbers[0], diceNumbers[1], diceNumbers[2]);
                }, 1000);
            } else {
                // Default bot response
                setTimeout(() => {
                    addBotMessage('Vui lòng nhập 3 số xúc xắc (ví dụ: 2 4 6)');
                }, 1000);
            }
        }
        
        function analyzeDiceForBot(dice1, dice2, dice3) {
            addBotMessage('Đang phân tích kết quả...');
            
            setTimeout(() => {
                const sum = dice1 + dice2 + dice3;
                const isTai = sum > 10;
                
                // Calculate probability (60-70% as requested)
                const winProbability = calculateTaiXiuProbability(dice1, dice2, dice3);
                
                // Predict next dice values
                const nextDicePrediction = predictNextDice(!isTai); // Predict opposite for more "intelligence"
                
                // Send prediction
                if (!isTai) { // Predict opposite of current result for better strategy
                    addBotMessage(`Dự đoán: <span class="tai">TÀI</span> (Tỉ lệ thắng: ${winProbability}%)`);
                    addBotMessage(`Dự đoán vị: <span class="tai">Tài: ${nextDicePrediction.values.join(', ')}</span>`);
                } else {
                    addBotMessage(`Dự đoán: <span class="xiu">XỈU</span> (Tỉ lệ thắng: ${winProbability}%)`);
                    addBotMessage(`Dự đoán vị: <span class="xiu">Xỉu: ${nextDicePrediction.values.join(', ')}</span>`);
                }
                
                // Add to history
                gameHistory.push({
                    dice: [dice1, dice2, dice3],
                    prediction: !isTai ? 'TÀI' : 'XỈU',
                    position: nextDicePrediction.values,
                    winProbability,
                    timestamp: new Date().toLocaleString(),
                    fromBot: true
                });
                
                localStorage.setItem('taiXiuGameHistory', JSON.stringify(gameHistory));
            }, 2000);
        }
        
        function addBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="bot-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            botMessages.appendChild(messageDiv);
            botMessages.scrollTop = botMessages.scrollHeight;
        }
        
        function addUserMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="user-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            botMessages.appendChild(messageDiv);
            botMessages.scrollTop = botMessages.scrollHeight;
        }
        
        botHistoryBtn.addEventListener('click', () => {
            renderHistory();
            historyModal.style.display = 'flex';
        });
        
        // Tool V3 functionality
        const startGameBtn = document.getElementById('start-game-btn');
        const gameContainer = document.getElementById('game-container');
        const gameFrame = document.getElementById('game-frame');
        const autoBotMessages = document.getElementById('auto-bot-messages');
        const gameOptions = document.querySelectorAll('.game-option');
        
        let currentGame = 'sunwin';
        let botInterval = null;
        
        // Game selection
        gameOptions.forEach(option => {
            option.addEventListener('click', () => {
                gameOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                currentGame = option.getAttribute('data-game');
            });
        });
        
        startGameBtn.addEventListener('click', () => {
            // Set game URL based on selection
            let gameUrl = '';
            switch (currentGame) {
                case 'sunwin':
                    gameUrl = 'https://sun.win/';
                    break;
                case 'hitclub':
                    gameUrl = 'https://hit.club/';
                    break;
                case '68gb':
                    gameUrl = 'https://68gbvn25.biz/';
                    break;
            }
            
            gameFrame.src = gameUrl;
            gameContainer.style.display = 'block';
            startGameBtn.style.display = 'none';
            
            // Start bot
            startAutoBot();
        });
        
        function startAutoBot() {
            // Clear previous interval if exists
            if (botInterval) {
                clearInterval(botInterval);
            }
            
            // Add initial message
            addAutoBotMessage('Bot đã bắt đầu phân tích game. Tự động dự đoán mỗi 50 giây.');
            
            // Start interval
            botInterval = setInterval(() => {
                // Simulate getting dice results from game
                const dice1 = Math.floor(Math.random() * 6) + 1;
                const dice2 = Math.floor(Math.random() * 6) + 1;
                const dice3 = Math.floor(Math.random() * 6) + 1;
                
                // Analyze
                const sum = dice1 + dice2 + dice3;
                const isTai = sum > 10;
                const winProbability = calculateTaiXiuProbability(dice1, dice2, dice3);
                const nextDicePrediction = predictNextDice(!isTai);
                
                // Send prediction
                if (!isTai) {
                    addAutoBotMessage(`Dự đoán: <span class="tai">TÀI</span> (Tỉ lệ thắng: ${winProbability}%)`);
                    addAutoBotMessage(`Dự đoán vị: <span class="tai">Tài: ${nextDicePrediction.values.join(', ')}</span>`);
                } else {
                    addAutoBotMessage(`Dự đoán: <span class="xiu">XỈU</span> (Tỉ lệ thắng: ${winProbability}%)`);
                    addAutoBotMessage(`Dự đoán vị: <span class="xiu">Xỉu: ${nextDicePrediction.values.join(', ')}</span>`);
                }
                
                // Add to history
                gameHistory.push({
                    dice: [dice1, dice2, dice3],
                    prediction: !isTai ? 'TÀI' : 'XỈU',
                    position: nextDicePrediction.values,
                    winProbability,
                    timestamp: new Date().toLocaleString(),
                    fromAutoBot: true
                });
                
                localStorage.setItem('taiXiuGameHistory', JSON.stringify(gameHistory));
                
            }, 50000); // 50 seconds
        }
        
        function addAutoBotMessage(text) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            
            const now = new Date();
            const timeString = now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
            
            messageDiv.innerHTML = `
                <div class="bot-message">
                    ${text}
                    <div class="message-time">${timeString}</div>
                </div>
            `;
            
            autoBotMessages.appendChild(messageDiv);
            autoBotMessages.scrollTop = autoBotMessages.scrollHeight;
        }
        
        // Initialize
        if (localStorage.getItem('taiXiuGameHistory')) {
            gameHistory = JSON.parse(localStorage.getItem('taiXiuGameHistory'));
        }
        
        // Play music when page loads
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                backgroundMusic.volume = 0.3;
                backgroundMusic.play().then(() => {
                    playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }).catch(e => {
                    console.log('Autoplay prevented:', e);
                });
            }, 1000);
        });
    </script>
</body>
</html>
